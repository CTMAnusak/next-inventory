# üì¶ TransferLogs Archive System Guide

‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£ TransferLogs ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏≤‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡πá‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏£‡πá‡∏ß

---

## üìã ‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç

1. [‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö](#‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö)
2. [‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•](#‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)
3. [‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå](#‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå)
4. [‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥](#‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)
5. [‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤](#‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤)

---

## ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö

‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ TransferLogs ‡πÅ‡∏ö‡∏ö**‡∏ï‡∏±‡∏î‡∏£‡∏≠‡∏ö‡∏ï‡∏≤‡∏°‡∏õ‡∏µ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô** (1 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° - 31 ‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°):

```
transferlogs (‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå - ‡∏õ‡∏µ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô)
    ‚Üì ‡∏£‡∏±‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ
transferlogs_archive (1-2 ‡∏õ‡∏µ‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á)
    ‚Üì Export ‡∏£‡∏≤‡∏¢‡∏õ‡∏µ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå
‡πÑ‡∏ü‡∏•‡πå JSON (2+ ‡∏õ‡∏µ - ‡πÄ‡∏Å‡πá‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£)
```

### ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
- **1 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2026**: Export + Archive + ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏µ 2025 (1/1/2025 00:00 - 31/12/2025 23:59)
- **1 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2027**: Export + Archive + ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏µ 2026 (1/1/2026 00:00 - 31/12/2026 23:59)

### ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå
- ‚úÖ ‡∏ï‡∏±‡∏î‡∏£‡∏≠‡∏ö‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏ï‡∏≤‡∏°‡∏õ‡∏µ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô
- ‚úÖ ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏≤ ‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô
- ‚úÖ ‡∏¢‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡πÑ‡∏î‡πâ
- ‚úÖ ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô

---

## ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

### 1. `transferlogs` (‡∏Ñ‡∏≠‡∏•‡πÄ‡∏•‡∏Å‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å)
- **‡πÄ‡∏Å‡πá‡∏ö**: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏µ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (1 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° - 31 ‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°)
- **‡∏î‡∏±‡∏ä‡∏ô‡∏µ**: ‡πÑ‡∏°‡πà‡∏°‡∏µ TTL (‡∏•‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏£‡∏±‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°)
- **‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö**: ‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏Å‡∏ï‡∏¥, ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
- **‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á**: ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ 6 ‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏° 2025 ‚Üí ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà 1/1/2025 ‡∏ñ‡∏∂‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô

### 2. `transferlogs_archive` (‡∏Ñ‡∏≠‡∏•‡πÄ‡∏•‡∏Å‡∏ä‡∏±‡∏ô Archive)
- **‡πÄ‡∏Å‡πá‡∏ö**: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 1-2 ‡∏õ‡∏µ‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á
- **‡∏¢‡πâ‡∏≤‡∏¢‡∏à‡∏≤‡∏Å**: `transferlogs` ‡∏£‡∏±‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ
- **‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö**: ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á
- **‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á**: ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ 6 ‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏° 2025 ‚Üí ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏µ 2024, 2023

### 3. ‡πÑ‡∏ü‡∏•‡πå JSON (backup_migration/transferlogs/)
- **‡πÄ‡∏Å‡πá‡∏ö**: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 2+ ‡∏õ‡∏µ ‡πÅ‡∏¢‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏≤‡∏¢‡∏õ‡∏µ
- **‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á**: `transferlogs_2023.json`, `transferlogs_2024.json`
- **‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö**: ‡πÄ‡∏Å‡πá‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß
- **‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö**: 1 ‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πà‡∏≠ 1 ‡∏õ‡∏µ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô (1/1 - 31/12)

---

## ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå

### 1Ô∏è‚É£ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡∏±‡∏ä‡∏ô‡∏µ (‡∏£‡∏±‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å)

```bash
# ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏î‡∏±‡∏ä‡∏ô‡∏µ‡πÉ‡∏´‡πâ transferlogs
npx tsx src/scripts/add-transferlogs-indexes.ts
```

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå**:
- ‡∏î‡∏±‡∏ä‡∏ô‡∏µ `itemId + transferDate` (‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)
- ‡∏î‡∏±‡∏ä‡∏ô‡∏µ `transferDate` (‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤)
- ‡∏î‡∏±‡∏ä‡∏ô‡∏µ `transferType + processedBy` (‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)
- **‡πÑ‡∏°‡πà‡∏°‡∏µ TTL** (‡∏à‡∏∞‡∏•‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÅ‡∏ö‡∏ö‡∏ï‡∏±‡∏î‡∏£‡∏≠‡∏ö‡∏õ‡∏µ)

---

### 2Ô∏è‚É£ Yearly Archive & Cleanup (‡∏£‡∏±‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°)

```bash
# ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: ‡∏£‡∏±‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏≠‡∏á)
npx tsx src/scripts/yearly-archive-cleanup.ts

# ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏£‡∏±‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
npx tsx src/scripts/yearly-archive-cleanup.ts --year=2025
```

**‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ó‡∏≥** (‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2026):
1. Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏µ 2025 (1/1/2025 00:00 - 31/12/2025 23:59) ‡πÑ‡∏õ‡πÑ‡∏ü‡∏•‡πå
2. ‡∏¢‡πâ‡∏≤‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏µ 2025 ‡πÑ‡∏õ `transferlogs_archive`
3. ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏µ 2025 ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å `transferlogs`

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå**:
```
üìÖ Today is January 1st - auto-processing year 2025
üì¶ Processing transferlogs for year 2025
   Start: 2025-01-01T00:00:00.000Z
   End: 2025-12-31T23:59:59.999Z
üìä Found 15000 records to process

üìù Step 1: Exporting to JSON file...
   ‚úÖ Exported 15000 records to transferlogs_2025.json (2.34 MB)

üì§ Step 2: Moving to transferlogs_archive...
   ‚úÖ Moved 15000 records to transferlogs_archive

üóëÔ∏è  Step 3: Deleting from transferlogs...
   ‚úÖ Deleted 15000 records from transferlogs

üéâ Yearly archive & cleanup completed!
```

---

### 3Ô∏è‚É£ Export ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ (‡πÑ‡∏°‡πà‡∏¢‡πâ‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏•‡∏ö)

#### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: ‡∏£‡∏±‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°
```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô 1 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°‡∏à‡∏∞ export ‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß
npx tsx src/scripts/export-transferlogs-yearly.ts
```

#### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö export ‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
```bash
# Export ‡∏õ‡∏µ 2024
npx tsx src/scripts/export-transferlogs-yearly.ts --year=2024

# Export ‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ
npx tsx src/scripts/export-transferlogs-yearly.ts --all
```

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå**:
```
üì¶ Exporting transferlogs for year 2024...
‚úÖ Exported 15000 records to transferlogs_2024.json (2.34 MB)
```

**‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏µ‡πà**: `backup_migration/transferlogs/transferlogs_2024.json`

---

### 4Ô∏è‚É£ Import ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏±‡∏ö

```bash
# Import ‡∏õ‡∏µ 2024 ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤ transferlogs_archive
npx tsx src/scripts/import-transferlogs-yearly.ts --year=2024

# Import ‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ
npx tsx src/scripts/import-transferlogs-yearly.ts --all

# Import ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏Ñ‡∏≠‡∏•‡πÄ‡∏•‡∏Å‡∏ä‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô
npx tsx src/scripts/import-transferlogs-yearly.ts --year=2024 --target=transferlogs
```

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå**:
```
üì• Importing from transferlogs_2024.json...
   Year: 2024, Records: 15000
‚úÖ Imported 15000 records
```

---

### 5Ô∏è‚É£ ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡∏à‡∏≤‡∏Å Database

```bash
# ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏µ 2023 (‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å export ‡πÅ‡∏•‡πâ‡∏ß)
npx tsx src/scripts/cleanup-archived-transferlogs.ts --year=2023

# ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ‡∏Å‡πà‡∏≠‡∏ô 2024
npx tsx src/scripts/cleanup-archived-transferlogs.ts --before=2024

# ‡∏Ç‡πâ‡∏≤‡∏° confirmation (‡∏£‡∏∞‡∏ß‡∏±‡∏á!)
npx tsx src/scripts/cleanup-archived-transferlogs.ts --year=2023 --force
```

**‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö**:
- ‚úÖ ‡πÑ‡∏ü‡∏•‡πå backup ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
- ‚è±Ô∏è ‡∏£‡∏≠ 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏ö (‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏°‡∏µ --force)

---

## ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥

### üåê Production (Vercel/Cloud) - **‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ 100%**

**‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß**: Vercel Cron ‡∏à‡∏∞‡∏£‡∏±‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà **1 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° ‡πÄ‡∏ß‡∏•‡∏≤ 02:00**

**‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£** - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞:
1. ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
2. ‚úÖ Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏õ‡πÑ‡∏ü‡∏•‡πå
3. ‚úÖ ‡∏¢‡πâ‡∏≤‡∏¢‡πÑ‡∏õ‡πÉ‡∏´‡∏°‡πà `transferlogs_archive`
4. ‚úÖ ‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å `transferlogs`

**‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Log**:
- Vercel Dashboard ‚Üí Functions ‚Üí Logs
- ‡∏î‡∏π‡∏ß‡πà‡∏≤ `/api/admin/cron/yearly-archive` ‡∏£‡∏±‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà

---

### üíª Local Development - **‡∏£‡∏±‡∏ô‡πÄ‡∏≠‡∏á**

```bash
# ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: ‡∏£‡∏±‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)
npx tsx src/scripts/yearly-archive-cleanup.ts

# ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API endpoint
curl -X POST http://localhost:3000/api/admin/cron/yearly-archive

# ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ PowerShell
Invoke-WebRequest -Uri "http://localhost:3000/api/admin/cron/yearly-archive" -Method POST
```

**‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà**: ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ archive ‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß

---

### ‡∏£‡∏≤‡∏¢‡∏õ‡∏µ (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£) - ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡∏à‡∏≤‡∏Å Archive
```bash
# ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡∏Å‡∏ß‡πà‡∏≤ 2 ‡∏õ‡∏µ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å transferlogs_archive
# (‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å export ‡πÑ‡∏õ‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡πâ‡∏ß)
npx tsx src/scripts/cleanup-archived-transferlogs.ts --before=2024
```

---

## ‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤

### ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏≤‡∏Å Database (1-2 ‡∏õ‡∏µ)
```javascript
// ‡πÉ‡∏ô MongoDB Compass ‡∏´‡∏£‡∏∑‡∏≠ code
db.transferlogs_archive.find({
  itemId: "68df8b68ddc0643ce146fb6a",
  transferDate: { $gte: new Date("2023-01-01") }
})
```

### ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå (2+ ‡∏õ‡∏µ)
```bash
# ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå JSON
cat backup_migration/transferlogs/transferlogs_2023.json

# ‡∏´‡∏£‡∏∑‡∏≠ import ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤ DB ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß
npx tsx src/scripts/import-transferlogs-yearly.ts --year=2023
```

---

## ‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á

1. **‡∏Å‡πà‡∏≠‡∏ô cleanup**: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ export ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß
2. **Backup ‡πÑ‡∏ü‡∏•‡πå**: ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå JSON ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏≠‡∏∑‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢ (Google Drive, S3)
3. **TTL Index**: ‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏á 365 ‡∏ß‡∏±‡∏ô ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤

---

## üîß Troubleshooting

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏´‡∏≤ MongoDB ‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠
```bash
# ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ environment variable
$env:MONGODB_URI="mongodb+srv://..."
npx tsx src/scripts/...
```

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Import ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡πâ‡∏≥
- ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ç‡πâ‡∏≤‡∏° duplicate key ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- ‡πÉ‡∏ä‡πâ `--force` ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡∏ö

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ
- Export ‡∏õ‡∏µ‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- ‡∏ö‡∏µ‡∏ö‡∏≠‡∏±‡∏î‡∏î‡πâ‡∏ß‡∏¢ gzip: `gzip transferlogs_2023.json`

---

## üìû ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô

‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢:
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö console log
2. ‡∏î‡∏π MongoDB Compass ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô `backup_migration/transferlogs/`

---

**‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠**: 2025-10-06  
**‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô**: 1.0

