# ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏±‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå (Complete System Documentation)

## üìã ‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç

1. [‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå](#1-‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå)
2. [‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡∏∞ Snapshot](#2-‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡∏∞-snapshot)
3. [‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Branch User Phone Snapshot](#3-‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç-branch-user-phone-snapshot)
4. [‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î](#4-‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)

---

## 1. ‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå

### ‚úÖ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

| ‡∏Å‡∏£‡∏ì‡∏µ | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ | ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£ | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞/‡∏™‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏Ñ‡∏∑‡∏ô | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏∞‡∏ö‡∏ö |
|------|-------------|---------|-----------------|-----------|
| 1 | ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• | ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏≠‡∏á | ‡∏´‡∏≤‡∏¢ + ‡∏ä‡∏≥‡∏£‡∏∏‡∏î | ‚úÖ ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ |
| 2 | ‡∏™‡∏≤‡∏Ç‡∏≤ | ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏≠‡∏á | ‡∏´‡∏≤‡∏¢ + ‡∏ä‡∏≥‡∏£‡∏∏‡∏î | ‚úÖ ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ |
| 3 | ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• | ‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå | ‡∏´‡∏≤‡∏¢ + ‡∏ä‡∏≥‡∏£‡∏∏‡∏î | ‚úÖ ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ |
| 4 | ‡∏™‡∏≤‡∏Ç‡∏≤ | ‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå | ‡∏´‡∏≤‡∏¢ + ‡∏ä‡∏≥‡∏£‡∏∏‡∏î | ‚úÖ ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ |

### üîÑ ‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå

#### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
```typescript
// ‡∏´‡∏ô‡πâ‡∏≤ /equipment-return
{
  statusOnReturn: 'status_missing',    // ‡∏´‡∏≤‡∏¢
  conditionOnReturn: 'cond_damaged',   // ‡∏ä‡∏≥‡∏£‡∏∏‡∏î
  statusOnReturnName: '‡∏´‡∏≤‡∏¢',
  conditionOnReturnName: '‡∏ä‡∏≥‡∏£‡∏∏‡∏î'
}
```

#### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô
```typescript
// API: /api/admin/equipment-return/approve
await changeItemStatus(
  item.itemId,
  'status_missing',  // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "‡∏´‡∏≤‡∏¢"
  'cond_damaged',    // ‡∏™‡∏†‡∏≤‡∏û "‡∏ä‡∏≥‡∏£‡∏∏‡∏î"
  adminUserId,
  '‡∏Ñ‡∏∑‡∏ô‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ'
);

await transferInventoryItem({
  fromOwnerType: 'user_owned',
  toOwnerType: 'admin_stock',
  transferType: 'return_completed'
});

await updateInventoryMaster(itemName, categoryId);
```

#### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï InventoryMaster
```typescript
// ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô
const availableToBorrow = adminStockItems.filter(item => 
  item.statusId === 'status_available' &&  // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "‡∏°‡∏µ"
  item.conditionId === 'cond_working'      // ‡∏™‡∏†‡∏≤‡∏û "‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ"
);

// ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
updatedMaster.totalQuantity = allItems.length;           // ‡∏ô‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡∏¥‡πâ‡∏ô
updatedMaster.availableQuantity = availableToBorrow.length; // ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏î‡πâ
updatedMaster.statusBreakdown = { status_missing: 1, ... };
updatedMaster.conditionBreakdown = { cond_damaged: 1, ... };
```

### üìä ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á

#### ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏î‡πâ"
- ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà **‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á** (‡∏°‡∏µ + ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ)

#### ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"
- ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞/‡∏™‡∏†‡∏≤‡∏û‡πÉ‡∏î)
- ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏≠‡∏á (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
- ‚úÖ **‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "‚ö†Ô∏è ‡∏ä‡∏≥‡∏£‡∏∏‡∏î/‡∏™‡∏π‡∏ç‡∏´‡∏≤‡∏¢:" ‡∏≠‡∏µ‡∏Å‡∏ï‡πà‡∏≠‡πÑ‡∏õ**

#### ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô "‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°"
- ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô: Status breakdown, Condition breakdown, Type breakdown

---

## 2. ‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡∏∞ Snapshot

### ‚úÖ ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏™‡∏±‡πâ‡∏ô

| ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° | ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö |
|-------|-------|
| **‡∏°‡∏µ‡∏Å‡∏≤‡∏£ snapshot ‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?** | ‚úÖ **‡πÉ‡∏ä‡πà** - ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥ snapshot ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ 2 ‡∏ä‡∏±‡πâ‡∏ô |
| **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏¢‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏•‡∏±‡∏á‡∏•‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?** | ‚ùå **‡πÑ‡∏°‡πà** - Frozen ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏ö |
| **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∑‡πà‡∏ô‡∏¢‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏•‡∏±‡∏á‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?** | ‚úÖ **‡πÑ‡∏î‡πâ** - ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‡∏™‡∏†‡∏≤‡∏û ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô |

### üîÑ ‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ

#### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°
```typescript
const userOwnedItems = await InventoryItem.find({
  'currentOwnership.ownerType': 'user_owned',
  'currentOwnership.userId': userToDelete.user_id
});

if (userOwnedItems.length > 0) {
  // ‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡πÑ‡∏î‡πâ - ‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Å‡πà‡∏≠‡∏ô
  return NextResponse.json({ 
    error: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ',
    message: `‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏°‡∏µ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå ${userOwnedItems.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏∑‡∏ô‡∏Å‡πà‡∏≠‡∏ô`
  }, { status: 400 });
}
```

#### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: Snapshot #1 - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
```typescript
const snapData = {
  userMongoId: userToDelete._id.toString(),
  user_id: userToDelete.user_id,
  userType: userToDelete.userType,
  
  // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏≤‡∏Ç‡∏≤
  ...(userToDelete.userType === 'branch' ? {
    office: userToDelete.office,
    email: userToDelete.email,
    // ‚ùå ‡πÑ‡∏°‡πà snapshot: firstName, lastName, nickname, department, phone
  } : {
    // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• - snapshot ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
    firstName: userToDelete.firstName,
    lastName: userToDelete.lastName,
    nickname: userToDelete.nickname,
    department: userToDelete.department,
    office: userToDelete.office,
    phone: userToDelete.phone,
    email: userToDelete.email,
  }),
  deletedAt: new Date()
};

await DeletedUsers.findOneAndUpdate(
  { userMongoId: snapData.userMongoId },
  snapData,
  { upsert: true, new: true }
);
```

#### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: Snapshot #2 - ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Logs
```typescript
const { snapshotUserBeforeDelete } = await import('@/lib/snapshot-helpers');
await snapshotUserBeforeDelete(userToDelete.user_id);

// ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞ snapshot ‡πÉ‡∏ô:
// 1. RequestLog (‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå)
// 2. ReturnLog (‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå)
// 3. TransferLog (‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå)
// 4. IssueLog (‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤)
```

#### ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
```typescript
await User.findByIdAndDelete(id);
```

### üì∏ ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î Snapshot Functions

#### 1. RequestLog Snapshot

**‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•:**
```typescript
updateFields = {
  requesterFirstName: user.firstName || '',
  requesterLastName: user.lastName || '',
  requesterNickname: user.nickname || '',
  requesterDepartment: user.department || '',
  requesterOffice: user.office || '',
  requesterPhone: user.phone || '',
  requesterEmail: user.email || ''
};
```

**‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏≤‡∏Ç‡∏≤:**
```typescript
updateFields = {
  requesterOffice: user.office || '',
  requesterEmail: user.email || ''
  // ‚ùå ‡πÑ‡∏°‡πà‡πÅ‡∏ï‡∏∞: firstName, lastName, nickname, department, phone
};
```

#### 2. ReturnLog Snapshot

**‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•:**
```typescript
updateFields = {
  returnerFirstName: user.firstName || '',
  returnerLastName: user.lastName || '',
  returnerNickname: user.nickname || '',
  returnerDepartment: user.department || '',
  returnerOffice: user.office || '',
  returnerPhone: user.phone || '',
  returnerEmail: user.email || ''
};
```

**‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏≤‡∏Ç‡∏≤:**
```typescript
updateFields = {
  returnerOffice: user.office || '',
  returnerEmail: user.email || ''
  // ‚ùå ‡πÑ‡∏°‡πà‡πÅ‡∏ï‡∏∞: firstName, lastName, nickname, department, phone
};
```

### üîç ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏á‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ

#### ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
```typescript
const user = await User.findOne({ user_id: userId });
if (user) {
  populated.firstName = user.firstName;  // Real-time
  populated.office = user.office;        // Real-time
}
```

#### ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß (Individual)
```typescript
const deletedUser = await DeletedUsers.findOne({ user_id: userId });
if (deletedUser && deletedUser.userType === 'individual') {
  populated.firstName = deletedUser.firstName;  // ‚ùÑÔ∏è Frozen
  populated.office = deletedUser.office;        // ‚ùÑÔ∏è Frozen
}
```

#### ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß (Branch)
```typescript
const deletedUser = await DeletedUsers.findOne({ user_id: userId });
if (deletedUser && deletedUser.userType === 'branch') {
  // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß: ‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°
  populated.firstName = populated.requesterFirstName || '-';
  populated.phone = populated.requesterPhone || '-';
  
  // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≤‡∏Ç‡∏≤: ‡∏à‡∏≤‡∏Å DeletedUsers
  populated.office = deletedUser.office || '-';    // ‚ùÑÔ∏è Frozen
  populated.email = deletedUser.email || '-';      // ‚ùÑÔ∏è Frozen
}
```

---

## 3. ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Branch User Phone Snapshot

### ‚ùå ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏î‡∏¥‡∏°

‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏£‡∏∞‡∏ö‡∏ö snapshot ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• "phone" ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏≤‡∏Ç‡∏≤ ‡πÅ‡∏ï‡πà‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡πÅ‡∏•‡πâ‡∏ß **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• phone ‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á** ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏á‡∏ó‡∏µ‡πà

### ‚úÖ ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

#### 1. DeletedUsers Collection
```typescript
// ‡∏Å‡πà‡∏≠‡∏ô
...(userToDelete.userType === 'branch' ? {
  office: userToDelete.office,
  phone: userToDelete.phone,  // ‚ùå Snapshot
  email: userToDelete.email,
} : { ... })

// ‡∏´‡∏•‡∏±‡∏á
...(userToDelete.userType === 'branch' ? {
  office: userToDelete.office,
  email: userToDelete.email,
  // ‚ùå ‡πÑ‡∏°‡πà snapshot phone ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á
} : { ... })
```

#### 2. RequestLog & ReturnLog
```typescript
// ‡∏Å‡πà‡∏≠‡∏ô
updateFields = {
  requesterOffice: user.office || '',
  requesterPhone: user.phone || '',  // ‚ùå Snapshot
  requesterEmail: user.email || ''
};

// ‡∏´‡∏•‡∏±‡∏á
updateFields = {
  requesterOffice: user.office || '',
  requesterEmail: user.email || ''
  // ‚ùå ‡πÑ‡∏°‡πà‡πÅ‡∏ï‡∏∞: firstName, lastName, nickname, department, phone
};
```

### üìä ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö

| ‡∏ü‡∏¥‡∏•‡∏î‡πå | ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• | ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏Ç‡∏≤ (‡∏Å‡πà‡∏≠‡∏ô) | ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏Ç‡∏≤ (‡∏´‡∏•‡∏±‡∏á) |
|------|------------|------------------|------------------|
| firstName | ‚úÖ Snapshot | ‚ùå ‡πÑ‡∏°‡πà snapshot | ‚ùå ‡πÑ‡∏°‡πà snapshot |
| lastName | ‚úÖ Snapshot | ‚ùå ‡πÑ‡∏°‡πà snapshot | ‚ùå ‡πÑ‡∏°‡πà snapshot |
| nickname | ‚úÖ Snapshot | ‚ùå ‡πÑ‡∏°‡πà snapshot | ‚ùå ‡πÑ‡∏°‡πà snapshot |
| department | ‚úÖ Snapshot | ‚ùå ‡πÑ‡∏°‡πà snapshot | ‚ùå ‡πÑ‡∏°‡πà snapshot |
| office | ‚úÖ Snapshot | ‚úÖ Snapshot | ‚úÖ Snapshot |
| **phone** | ‚úÖ Snapshot | ~~‚úÖ Snapshot~~ | ‚ùå **‡πÑ‡∏°‡πà snapshot** |
| email | ‚úÖ Snapshot | ‚úÖ Snapshot | ‚úÖ Snapshot |

### üéØ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

#### ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏Ç‡∏≤ "‡∏™‡∏≤‡∏Ç‡∏≤‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û" ‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå:

**‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
// ‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°
requesterPhone: "0812345678"  // ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß

// ‡∏´‡∏•‡∏±‡∏á‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‚Üí Snapshot phone ‡∏à‡∏≤‡∏Å User
requesterPhone: "02-123-4567"  // ‚ùå ‡∏ñ‡∏π‡∏Å override ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏™‡∏≤‡∏Ç‡∏≤ (‡∏ú‡∏¥‡∏î!)
```

**‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
```javascript
// ‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°
requesterPhone: "0812345678"  // ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß

// ‡∏´‡∏•‡∏±‡∏á‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‚Üí ‡πÑ‡∏°‡πà snapshot phone
requesterPhone: "0812345678"  // ‚úÖ ‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å (‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!)
```

---

## 4. ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

### üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏±‡∏á‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ

| ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏´‡∏•‡∏±‡∏á‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |
|--------|------------------|----------|
| **‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå** | ‚úÖ ‡∏¢‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÑ‡∏î‡πâ | ‡∏°‡∏µ snapshot function ‡πÅ‡∏¢‡∏Å‡∏≠‡∏¥‡∏™‡∏£‡∏∞ |
| **‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà** | ‚úÖ ‡∏¢‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÑ‡∏î‡πâ | ‡∏°‡∏µ snapshot function ‡πÅ‡∏¢‡∏Å‡∏≠‡∏¥‡∏™‡∏£‡∏∞ |
| **‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞** | ‚úÖ ‡∏¢‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÑ‡∏î‡πâ | ‡∏°‡∏µ snapshot function ‡πÅ‡∏¢‡∏Å‡∏≠‡∏¥‡∏™‡∏£‡∏∞ |
| **‡∏™‡∏†‡∏≤‡∏û** | ‚úÖ ‡∏¢‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÑ‡∏î‡πâ | ‡∏°‡∏µ snapshot function ‡πÅ‡∏¢‡∏Å‡∏≠‡∏¥‡∏™‡∏£‡∏∞ |
| **‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô** | ‚úÖ ‡∏¢‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÑ‡∏î‡πâ | ‡∏ñ‡πâ‡∏≤‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏¢‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö |
| **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏•‡∏ö** | ‚ùå ‡πÑ‡∏°‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏≠‡∏µ‡∏Å | Frozen ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏ö |

### üìù ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ 2 ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó

| ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ | ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• (Individual) | ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏Ç‡∏≤ (Branch) |
|--------|-------------------------|---------------------|
| **Snapshot ‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏ö** | ‡∏ó‡∏∏‡∏Å‡∏ü‡∏¥‡∏•‡∏î‡πå | ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ office, email |
| **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß** | ‡∏à‡∏≤‡∏Å User/DeletedUsers | ‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á |
| **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≤‡∏Ç‡∏≤** | ‡∏à‡∏≤‡∏Å User/DeletedUsers | office, email ‡∏à‡∏≤‡∏Å User/DeletedUsers |
| **‡∏´‡∏•‡∏±‡∏á‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ** | Frozen ‡∏ó‡∏∏‡∏Å‡∏ü‡∏¥‡∏•‡∏î‡πå | Frozen ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ office, email |

### üéØ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á

#### ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå: ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏Ç‡∏≤ "‡∏™‡∏≤‡∏Ç‡∏≤‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û" ‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÅ‡∏•‡πâ‡∏ß‡∏ñ‡∏π‡∏Å‡∏•‡∏ö

**‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏ö:**
```javascript
// User Collection
{
  user_id: "B001",
  userType: "branch",
  office: "‡∏™‡∏≤‡∏Ç‡∏≤‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û",
  phone: "02-123-4567",  // ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏™‡∏≤‡∏Ç‡∏≤
  email: "bangkok@company.com"
}

// RequestLog (‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏ö‡∏¥‡∏Å)
{
  userId: "B001",
  requesterFirstName: "‡∏™‡∏°‡∏ä‡∏≤‡∏¢",      // ‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°
  requesterLastName: "‡πÉ‡∏à‡∏î‡∏µ",        // ‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°
  requesterPhone: "0812345678",     // ‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏° (‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß)
  itemName: "Mouse Logitech",
  statusName: "‡∏°‡∏µ",
  conditionName: "‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ"
}
```

**‡∏´‡∏•‡∏±‡∏á‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ + ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå:**
```javascript
// DeletedUsers Collection
{
  user_id: "B001",
  userType: "branch",
  office: "‡∏™‡∏≤‡∏Ç‡∏≤‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û",  // ‚úÖ Snapshot
  email: "bangkok@company.com",  // ‚úÖ Snapshot
  // ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ phone (‡πÑ‡∏°‡πà snapshot)
}

// RequestLog (‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≤‡∏Ç‡∏≤)
{
  userId: "B001",
  requesterFirstName: "‡∏™‡∏°‡∏ä‡∏≤‡∏¢",      // ‚úÖ ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°
  requesterLastName: "‡πÉ‡∏à‡∏î‡∏µ",        // ‚úÖ ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°
  requesterPhone: "0812345678",     // ‚úÖ ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°
  requesterOffice: "‡∏™‡∏≤‡∏Ç‡∏≤‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û",  // ‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏à‡∏≤‡∏Å User
  requesterEmail: "bangkok@company.com",  // ‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏à‡∏≤‡∏Å User
  itemName: "Mouse Logitech V2",    // ‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÑ‡∏î‡πâ (‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç)
  statusName: "‡∏´‡∏≤‡∏¢",                // ‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÑ‡∏î‡πâ (‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç)
  conditionName: "‡∏ä‡∏≥‡∏£‡∏∏‡∏î"            // ‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÑ‡∏î‡πâ (‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç)
}
```

**‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á:**
```javascript
{
  // ‚ùÑÔ∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô Frozen, ‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°)
  firstName: "‡∏™‡∏°‡∏ä‡∏≤‡∏¢",             // ‚úÖ ‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°
  lastName: "‡πÉ‡∏à‡∏î‡∏µ",               // ‚úÖ ‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°
  phone: "0812345678",            // ‚úÖ ‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏° (‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß)
  office: "‡∏™‡∏≤‡∏Ç‡∏≤‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û",         // ‚ùÑÔ∏è ‡∏à‡∏≤‡∏Å DeletedUsers
  email: "bangkok@company.com",   // ‚ùÑÔ∏è ‡∏à‡∏≤‡∏Å DeletedUsers
  
  // ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∑‡πà‡∏ô (‡∏¢‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÑ‡∏î‡πâ)
  itemName: "Mouse Logitech V2",  // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏•‡πâ‡∏ß!
  statusName: "‡∏´‡∏≤‡∏¢",              // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏•‡πâ‡∏ß!
  conditionName: "‡∏ä‡∏≥‡∏£‡∏∏‡∏î"          // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏•‡πâ‡∏ß!
}
```

### üîß Snapshot Functions ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö

#### User Deletion Snapshots
```typescript
// src/lib/snapshot-helpers.ts
export async function snapshotUserBeforeDelete(userId: string);
export async function snapshotIssueLogsBeforeUserDelete(userId: string);

// src/lib/equipment-snapshot-helpers.ts
export async function snapshotEquipmentLogsBeforeUserDelete(userId: string);
export async function snapshotRequestLogsBeforeUserDelete(userId: string);
export async function snapshotReturnLogsBeforeUserDelete(userId: string);
export async function snapshotTransferLogsBeforeUserDelete(userId: string);
```

#### Config Change Snapshots
```typescript
// src/lib/equipment-snapshot-helpers.ts
export async function snapshotCategoryConfigBeforeChange(categoryId: string, newName?: string);
export async function snapshotStatusConfigBeforeChange(statusId: string, newName?: string);
export async function snapshotConditionConfigBeforeChange(conditionId: string, newName?: string);
```

#### Equipment Change Snapshots
```typescript
// src/lib/equipment-snapshot-helpers.ts
export async function snapshotEquipmentNameBeforeChange(itemId: string, oldName: string, newName: string);
export async function snapshotItemNameBeforeDelete(masterId: string);
```

---

## üéâ ‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢

### ‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
1. ‚úÖ **‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå** - ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•/‡∏™‡∏≤‡∏Ç‡∏≤, ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏á/‡πÄ‡∏ö‡∏¥‡∏Å, ‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞/‡∏™‡∏†‡∏≤‡∏û
2. ‚úÖ **‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á** - availableQuantity, totalQuantity, breakdown
3. ‚úÖ **‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á** - ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤, ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î

### ‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
1. ‚úÖ **Snapshot ‡∏Ñ‡∏£‡∏ö 2 ‡∏ä‡∏±‡πâ‡∏ô** - DeletedUsers + Logs
2. ‚úÖ **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ Frozen** - ‡πÑ‡∏°‡πà‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏•‡∏±‡∏á‡∏•‡∏ö
3. ‚úÖ **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∑‡πà‡∏ô‡∏¢‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÑ‡∏î‡πâ** - ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‡∏™‡∏†‡∏≤‡∏û ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà

### ‚úÖ ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Branch User Phone
1. ‚úÖ **‡πÑ‡∏°‡πà snapshot phone** - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏Ç‡∏≤
2. ‚úÖ **‡πÉ‡∏ä‡πâ phone ‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°** - ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á
3. ‚úÖ **Snapshot ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ office, email** - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏á‡∏ó‡∏µ‡πà

### üìö ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á

#### API Endpoints
- `DELETE /api/admin/users/[id]` - ‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏û‡∏£‡πâ‡∏≠‡∏° snapshot
- `POST /api/admin/equipment-return/approve` - ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
- `GET /api/admin/inventory` - ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤

#### Helper Functions
- `src/lib/snapshot-helpers.ts` - User snapshot functions
- `src/lib/equipment-snapshot-helpers.ts` - Equipment/Config snapshot functions
- `src/lib/equipment-populate-helpers.ts` - Populate functions
- `src/lib/inventory-helpers.ts` - Inventory management functions

#### Frontend Pages
- `src/app/admin/inventory/page.tsx` - ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
- `src/app/equipment-return/page.tsx` - ‡∏´‡∏ô‡πâ‡∏≤‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå

#### Models
- `src/models/DeletedUser.ts` - Schema ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö snapshot ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏•‡∏ö
- `src/models/InventoryMaster.ts` - Schema ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏£‡∏∏‡∏õ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
- `src/models/RequestLog.ts` - ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
- `src/models/ReturnLog.ts` - ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå

**‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡πÅ‡∏ö‡∏ö! ‡πÑ‡∏°‡πà‡∏°‡∏µ Error ‡πÉ‡∏î‡πÜ!** üöÄ

---

*‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏±‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå ‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Snapshot ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î*
